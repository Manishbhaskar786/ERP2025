@* @using ERPack.Web.Startup
@using ERPack.MultiTenancy.Dto
@using ERPack.Web.Models.Common.Modals
@model TenantDto
@{
    ViewBag.Title = L("Edit");
    ViewBag.CurrentPageName = PageNames.EditTenant;
}
@section scripts
    {
    <environment names="Development">
        <script src="~/view-resources/Views/Tenants/EditTenant.js" asp-append-version="true"></script>
    </environment>

    <environment names="Staging,Production">
        <script src="~/view-resources/Views/Tenants/EditTenant.min.js" asp-append-version="true"></script>
    </environment>
}
<section class="content-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-6">
                <h1>@L("Edit")</h1>
            </div>
        </div>
    </div>
</section>
<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <form name="TenantEditForm" id="tenantEditForm" role="form" class="form-horizontal" enctype="multipart/form-data">
                        <div class="card-body">
                            <input id="Id" type="hidden" Name="Id" class="form-control" value="@Model.Id">
                            <input id="tenancyName" type="hidden" Name="TenancyName" class="form-control" value="@Model.TenancyName">
                            <input id="name" type="hidden" Name="Name" class="form-control" value="@Model.Name">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label>@L("Address")</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-map-marker"></i></span>
                                            </div>
                                            <input type="text" class="form-control" value="@Model.Address1" name="Address1" id="Address1">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>@L("Address")2</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-map-marker"></i></span>
                                            </div>
                                            <input type="text" class="form-control" name="Address2" value="@Model.Address2" id="Address2">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>@L("City")</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-city"></i></span>
                                            </div>
                                            <input type="text" class="form-control" name="City" value="@Model.City" id="City">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>@L("State")</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                                            </div>
                                            <input type="text" class="form-control" name="State" value="@Model.State" id="State">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>@L("Pincode")</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-map-pin"></i></span>
                                            </div>
                                            <input type="text" class="form-control" name="Pincode" value="@Model.PinCode" id="Pincode">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>@L("Country")</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-flag"></i></span>
                                            </div>
                                            <input type="text" class="form-control" name="Country" value="@Model.Country" id="Country">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="logoFile">Upload Logo</label>
                                        <div class="input-group">
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input" name="LogoFile" id="logoFile">
                                                <label class="custom-file-label" for="logoFile">Choose File</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-primary float-right save-button">@L("Save")</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
 *@






@using ERPack.Web.Startup
@using ERPack.MultiTenancy.Dto
@using ERPack.Web.Models.Common.Modals
@model TenantDto
@{
    ViewBag.Title = L("EditHostInfo");
    ViewBag.CurrentPageName = PageNames.EditTenant;
}
@section scripts
{
    <environment names="Development">
        <script src="~/view-resources/Views/HostInfo/EditHostInfo.js" asp-append-version="true"></script>
    </environment>

    <environment names="Staging,Production">
        <script src="~/view-resources/Views/HostInfo/EditHostInfo.min.js" asp-append-version="true"></script>
    </environment>
}
<section class="content-header">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-6">
                <h1>Edit Tenant Info</h1>
            </div>
        </div>
    </div>
</section>
<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <form name="TenantEditForm" id="EditHostForm" role="form" class="form-horizontal" enctype="multipart/form-data">
                        <div class="card-body">
                            <input id="Id" type="hidden" Name="Id" class="form-control" value="@Model.Id">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="form-group">
                                        <label>Company Name<span class="text-danger">*</span></label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-map-marker"></i></span>
                                            </div>
                                            <input type="text" class="form-control required" value="@Model.Name" name="CompanyName" id="CompanyName" disabled>
                                            @* <span asp-validation-for="@Model.Name" class="text-danger"></span> *@
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Company Short Name</label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-map-marker"></i></span>
                                            </div>
                                            <input type="text" class="form-control" name="CompanyShortName" value="@Model.CompanyShortName" id="CompanyShortName">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Company Logo (For Documents)</label>
                                        <div class="input-group">
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input form-control" name="DocumentsLogoFile" id="documentsLogoFile">
                                                <label class="custom-file-label" for="documentsLogoFile">@(!string.IsNullOrEmpty(Model?.DocumentsLogo) ? Model.DocumentsLogo : "Choose File")</label>
                                                <input type="hidden" class="custom-filename-hidden" id="hdnDocumentsLogoFile" value="@Model.DocumentsLogo" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Company Logo (For Site)</label>
                                        <div class="input-group">
                                            <div class="custom-file">
                                                <input type="file" class="custom-file-input form-control" name="LogoFile" id="logoFile">
                                                <label class="custom-file-label" for="logoFile">@(!string.IsNullOrEmpty(Model?.Logo) ? Model.Logo : "Choose File")</label>
                                                <input type="hidden" class="custom-filename-hidden" id="hdnLogoFile" value="@Model.Logo" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Default Currency<span class="text-danger">*</span></label>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa fa-flag"></i></span>
                                            </div>
                                            @* <input type="text" class="form-control" name="Currency" value="@Model.Currency" id="CurrencyId"> *@
                                            <select class="form-control required" id="BusinessCurrencyId" name="Currency">
                                                <option value="" selected>Select Currency</option>
                                                @foreach (var v in Model.Currencies)
                                                {
                                                    if (v.Id == Convert.ToInt32(Model.Currency))
                                                    {
                                                        <option value="@v.Id" selected>@v.Name</option>
                                                    }
                                                    else
                                                    {
                                                        <option value="@v.Id">@v.Name</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-primary float-right save-button">@L("Save")</button>
                        </div>
                    </form>
                    <div class="mt-5">
                        <div class="align-items-center d-flex justify-content-between row">
                            <div class="ml-2">
                                <h1 style="font-size: 2rem;">
                                    Company Taxation/Address Details
                                </h1>
                            </div>
                            <div class="mr-4">
                                <a class="btn bg-blue float-sm-right" onclick="openAddEditModal(0)">Add Details</a>
                            </div>
                        </div>
                        <hr class="border-dark m-0 mb-4" />
                        <table id="taxationDetailsTable" class="table table-striped table-bordered nowrap">
                            <thead>
                                <tr>
                                    <th class="selectAll"></th>
                                    <th>AddressName</th>
                                    <th>@L("Address")</th>
                                    <th>Address 2</th>
                                    <th>@L("City")</th>
                                    <th>@L("State")</th>
                                    <th>@L("Country")</th>
                                    <th>@L("Pincode")</th>
                                    <th>Pan No.</th>
                                    <th>is Default</th>
                                    <th>@L("Actions")</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="modal fade" id="AddEditHostTaxationModal" tabindex="-1" role="dialog" aria-labelledby="TenantCreateModalLabel" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document" style="top:15%">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Add Taxation Details</h5>
                <button type="button" class="btn btn-close" data-dismiss="modal" aria-label="Close"><i class="fa fa-times"></i></button>
            </div>
            <div class="modal-body">
            </div>
        </div>
    </div>
</div>

<script>
    const logoFileInput = document.getElementById('logoFile');
    const logoFileLabel = document.querySelector('.custom-file-label');

    logoFileInput.addEventListener('change', function () {
        const fileName = this.files[0] ? this.files[0].name : '';
        logoFileLabel.textContent = fileName;
        // if (fileName != "Choose File") {
        //     const guid = generateGUID();
        //     logoFileLabel.textContent = fileName
        //         + "_"
        //         + guid.Substring(0, 4)
        //         + getFileExtension(fileName);
        // }
        // else { logoFileLabel.textContent = fileName;  }
    });

    // function generateGUID() {
    //     return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
    //         const r = Math.random() * 16 | 0;
    //         const v = c === 'x' ? r : (r & 0x3 | 0x8);
    //         return v.toString(16);
    //     });
    // }

    // function getFileExtension(filename) {
    //     const parts = filename.split('.');
    //     return parts.length > 1 ? parts.pop() : '';
    // }

    function openAddEditModal(hostTaxationId) {
        $.ajax({
            url: '@Url.Action("AddEditCompanyTaxationDetails", "Tenants")',
            type: 'GET',
            data: { hostTaxationId: hostTaxationId },
            success: function (result) {
                $('#AddEditHostTaxationModal .modal-body').html(result);
                $('#AddEditHostTaxationModal').modal('show');
                $(".modal-backdrop").hide()
            },
            error: function (xhr, status, error) {
            }
        });
    }
</script>